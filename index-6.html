<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Stuff about stuff">
<meta name="viewport" content="width=device-width">
<title>Graham Wheeler's Random Forest (old posts, page 6) | Graham Wheeler's Random Forest</title>
<link href="assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="assets/css/code.css" rel="stylesheet" type="text/css">
<link href="assets/css/theme.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="assets/css/screen.css">
<link rel="stylesheet" type="text/css" href="assets/css/nav.css">
<link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic%7COpen+Sans:700,400%7CInconsolata">
<link href="assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds.feedburner.com/GrahamWheelersRandomForest">
<link rel="canonical" href="https://www.grahamwheeler.com/index-6.html">
<link rel="prev" href="index.html" type="text/html">
<link rel="next" href="index-5.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body class="nav-closed">

<div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
<li class="nav-opened" role="presentation">
            <a href="index.html">Home</a>
        </li>
        <li class="nav-opened" role="presentation">
            <a href="archive.html">Archives</a>
        </li>
        <li class="nav-opened" role="presentation">
            <a href="categories/index.html">Tags</a>
        </li>
        <li class="nav-opened" role="presentation">
            <a href="rss.xml">RSS</a>
        </li>
        <li class="nav-opened" role="presentation">
            <a href="https://twitter.com/gramnix">My Twitter</a>
        </li>
        <li class="nav-opened" role="presentation">
            <a href="https://github.com/gramster">My Github</a>
        </li>
        <li class="nav-opened" role="presentation">
            <a href="https://www.linkedin.com/in/grahamwheeler">My LinkedIn</a>
        </li>
    
    
    </ul>
</div>
<span class="nav-cover"></span>

<div class="site-wrapper">
    <header class="main-header" style="background-image: url(images/autumn-3295747_1280.jpg)"><nav class="main-nav overlay clearfix"><a class="blog-logo" href="https://www.grahamwheeler.com/"><img src="https://getnikola.com/assets/img/logo.svg" alt="Blog Logo"></a>
            <a class="menu-button" href="#"><span class="burger">☰</span><span class="word">Menu</span></a>
        </nav><div class="vertical">
            <div class="main-header-content inner">
                <a href="https://github.com/gramster" target="_blank">
                    <span class="icon-github" style="color:white;font-size:2em"></span>
                </a>
                 
                <a class="bloglogo" href="https://twitter.com/gramnix" target="_blank">
                    <span class="icon-twitter" style="color:white;font-size:2em"></span>
                </a>
                 
                <h1 class="page-title">Graham Wheeler's Random Forest (old posts, page 6)</h1>
                <h2 class="page-description">Stuff about stuff</h2>
            </div>
        </div>
        <a class="scroll-down icon-arrow-left" href="#content"><span class="hidden">Scroll Down</span></a>
    </header><main id="content" class="content" role="main"><div class="postindex">


<article class="post post"><header class="post-header"><h2 class="post-title"><a href="posts/zite-replacement-4.html">Building a Zite Replacement (Part 4)</a></h2>
    </header><section class="post-excerpt"><div>
<p>Following my <a href="http://www.grahamwheeler.com/posts/zite-replacement-3.html">last post</a>, I started gathering URLs of feeds to use for sample data. First I scraped the links that I had saved in Pocket (a scarily large number). It didn't seem like Pocket had an easy way to export this, so I loaded up Pocket in Chrome, scrolled and scrolled and scrolled until I could scroll no more, then saved the resulting web page once it was done loading. It was pretty easy to then scrape that to get the links. After sorting and uniq-ing those, and running them through <a href="http://www.aaronsw.com/2002/feedfinder/">feedfinder</a>, I had somewhere north of 1000 feeds. However, these were very skewed to my interests and I wanted diversity so I pressed on and scraped a bunch of blog rolls and other link collections covering many other areas. In the end I got about 2,500 feed URLs to start with, in a file named 'feeds.txt'.</p>
<p>At that point I ran the code below to fetch and categorize the articles.</p>
<table class="codehilitetable"><tr>
<td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td>
<td class="code">
<pre class="code literal-block"><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'feeds.txt'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">feeds</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'articles.txt'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">feed</span> <span class="ow">in</span> <span class="n">feeds</span><span class="p">:</span>
        <span class="n">feed</span> <span class="o">=</span> <span class="n">feed</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">feed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">print</span> <span class="n">feed</span>
        <span class="n">when</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>
        <span class="n">articles</span> <span class="o">=</span> <span class="n">get_feed_with_tf_idf</span><span class="p">(</span><span class="n">feed</span><span class="p">)</span>
        <span class="k">print</span> <span class="s1">'</span><span class="si">%d</span><span class="s1"> articles processed from feed </span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">articles</span><span class="p">),</span> <span class="n">feed</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">article</span> <span class="ow">in</span> <span class="n">articles</span><span class="p">:</span>
            <span class="n">record</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'feed'</span><span class="p">:</span> <span class="n">feed</span><span class="p">,</span> 
                      <span class="s1">'fetched'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">when</span><span class="p">),</span>
                      <span class="s1">'category'</span><span class="p">:</span> <span class="n">article</span><span class="p">[</span><span class="s1">'category'</span><span class="p">],</span>
                      <span class="s1">'link'</span><span class="p">:</span> <span class="n">article</span><span class="p">[</span><span class="s1">'link'</span><span class="p">],</span> 
                      <span class="s1">'date'</span><span class="p">:</span> <span class="n">article</span><span class="p">[</span><span class="s1">'date'</span><span class="p">],</span>
                      <span class="s1">'terms'</span><span class="p">:</span> <span class="n">article</span><span class="p">[</span><span class="s1">'terms'</span><span class="p">],</span>
                      <span class="s1">'title'</span><span class="p">:</span> <span class="n">article</span><span class="p">[</span><span class="s1">'title'</span><span class="p">],</span>
                      <span class="s1">'thumbnail'</span><span class="p">:</span> <span class="n">article</span><span class="p">[</span><span class="s1">'media_thumbnail'</span><span class="p">]</span>
            <span class="p">}</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">record</span><span class="p">))</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
</pre>
</td>
</tr></table>
<p>It ran surprisingly fast; it actually took a lot longer to find the feed URLs than it did to fetch the articles and do term extraction. A number of sites returned 0 articles and I need to do  prune of those from the feed list as they are probably either dead or uninteresting.</p>
<p>Once that was done I had close to 40,000 articles to work with. A simple approach is to not even bother going further and just use the extracted terms for deciding what articles to show. I could probably get pretty good results this way; for example, where Zite would typically give me about ten articles on Clojure, I already have over 200!  But I'd like to press on and do some clustering and use that for higher-level tagging and eventually supervised learning.</p>
<p>For clustering we need some way of measuring <a href="https://en.wikipedia.org/wiki/Similarity_measure">similarity</a>
between articles (or conversely, distance). For <a href="https://en.wikipedia.org/wiki/Categorical_variable">categorical data</a>
(as opposed to quantitative data), like our lists of terms, a simple but highly effective measure is
<a href="https://en.wikipedia.org/wiki/Jaccard_index">Jacard similarity</a>, which is the size of the intersection 
of our list of terms divided by the size of the union. For example, if one document had the terms 'Obama', 'president', 'visit', and the other had the terms 'Trump', 'president', 'campaign', 'Fiorina', then the Jacard similarity of these documents would be 2/6. The Jacard distance is just 1 - the similarity. Some algorithms work with similarities and some with distances so it is useful to know how to compute both. For points in n-dimensional space, for example, distance is usually Euclidean distance (the square root of the sum of the squares of the distances on each axis), while similarity would be 1/distance,  or some other value that increases as distance decreases; we want to avoid division by zero so 1 / (1 + distance) is more common.</p>
<p>Calculating the Jacard similarity of all the pairwise combinations of nearly 40,000 items is no mean feat, and to make this tractable in an interpreted language like Python you have to leverage libraries that have efficient native implementations under the hood very effectively. I found the code below not too bad; it took about 20 minutes on my MacBook Pro:</p>
<table class="codehilitetable"><tr>
<td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></div></td>
<td class="code">
<pre class="code literal-block"><span></span><span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="kn">import</span> <span class="nn">json</span>

<span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Load the articles back in.</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'articles.txt'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="c1"># We will add line number info in for easy cross reference.</span>
    <span class="n">linenum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
        <span class="n">linenum</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">ve</span><span class="p">:</span>
            <span class="k">print</span> <span class="s2">"Failed to parse line </span><span class="si">%d</span><span class="s2">: </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">linenum</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">ve</span><span class="p">)</span>
        <span class="c1"># Drop any that have no terms.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">'terms'</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">'feed'</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="s1">'feed'</span><span class="p">],</span> 
                     <span class="s1">'line'</span><span class="p">:</span> <span class="n">linenum</span><span class="p">,</span>
                     <span class="s1">'title'</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="s1">'title'</span><span class="p">],</span>
                     <span class="s1">'terms'</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">'terms'</span><span class="p">])})</span>


<span class="k">def</span> <span class="nf">jacard_similarity</span><span class="p">(</span><span class="n">row1</span><span class="p">,</span> <span class="n">row2</span><span class="p">):</span>
    <span class="sd">""" Jacard similarity is the size of the intersection divided by the union.</span>
<span class="sd">    """</span>
    <span class="n">set1</span> <span class="o">=</span> <span class="n">row1</span><span class="p">[</span><span class="s1">'terms'</span><span class="p">]</span>
    <span class="n">set2</span> <span class="o">=</span> <span class="n">row2</span><span class="p">[</span><span class="s1">'terms'</span><span class="p">]</span>
    <span class="n">intersection_len</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">set1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">set2</span><span class="p">)))</span>
    <span class="n">union_len</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">set1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">set2</span><span class="p">)</span> <span class="o">-</span> <span class="n">intersection_len</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">intersection_len</span> <span class="o">/</span> <span class="n">union_len</span>

<span class="c1"># Compute the pairwise distance matrix. We do the upper triangle.</span>
<span class="n">similarity_generator</span> <span class="o">=</span> <span class="p">(</span><span class="n">jacard_similarity</span><span class="p">(</span><span class="n">row1</span><span class="p">,</span> <span class="n">row2</span><span class="p">)</span> \
    <span class="k">for</span> <span class="n">row1</span><span class="p">,</span> <span class="n">row2</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">upper_triangle</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(</span><span class="n">similarity_generator</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</pre>
</td>
</tr></table>
<p>This computes the upper triangle, and we would need to make a reflection around the diagonal to complete a square matrix. Note how we leverage Python sets for efficient calculation of union and intersection, and use itertools instead of explicit loops. To complete the matrix we can do this:</p>
<table class="codehilitetable"><tr>
<td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td>
<td class="code">
<pre class="code literal-block"><span></span><span class="kn">import</span> <span class="nn">scipy.spatial</span>
<span class="c1"># Expand to a square</span>
<span class="n">distance_matrix</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">squareform</span><span class="p">(</span><span class="n">upper_triangle</span><span class="p">)</span>
</pre>
</td>
</tr></table>
<p>Once we have this matrix we can use it for our clustering. The approach I am interested in trying is <a href="https://en.wikipedia.org/wiki/Affinity_propagation">affinity propagation</a>. The implementation in SciKit can use a precomputed similarity matrix and apparently its a very good algorithm for finding optimal clusters, but it is quadratic so computing clusters will be slow.</p>
<p>The code to compute the clusters is below:</p>
<table class="codehilitetable"><tr>
<td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td>
<td class="code">
<pre class="code literal-block"><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">AffinityPropagation</span>

<span class="n">af</span> <span class="o">=</span> <span class="n">AffinityPropagation</span><span class="p">(</span><span class="n">affinity</span><span class="o">=</span><span class="s1">'precomputed'</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">distance_matrix</span><span class="p">)</span>

<span class="n">cluster_centers_indices</span> <span class="o">=</span> <span class="n">af</span><span class="o">.</span><span class="n">cluster_centers_indices_</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">af</span><span class="o">.</span><span class="n">labels_</span>

<span class="n">n_clusters_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cluster_centers_indices</span><span class="p">)</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_clusters_</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">"Cluster </span><span class="si">%d</span><span class="se">\n</span><span class="s2">"</span> <span class="o">%</span> <span class="n">k</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">labels</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">==</span> <span class="n">k</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
</pre>
</td>
</tr></table>
<p>Starting with smaller samples, for 1000 articles I got about 160 clusters; for 2000 about 290, and for 3000, 410.
Some of the clusters make sense (e.g. I see some recipes being clustered) but a lot don't. I expect there are three reasons for this: the small sample across diverse topics mean lots of articles have no common terms, possibly I need more terms, the algorithm is running with all defaults and hasn't been tuned, and of course it is possible I have bugs; I have not validated the Jacard values. So I will need to go deeper. Amongst other things I think I should drop any terms that only occur in single documents as they add cost but no benefit; I found that there are only about 20% of the terms that actually occur in two or more documents.</p>
<p>Watch this space!</p>
</div>
    </section><footer class="post-meta"><a href="authors/graham-wheeler.html">Graham Wheeler</a>

        on

        <time class="post-date" datetime="2015-09-22T21:01:00-07:00">
            2015-09-22 21:01
        </time></footer></article><article class="post post"><header class="post-header"><h2 class="post-title"><a href="posts/zite-replacement-3.html">Building a Zite Replacement (Part 3)</a></h2>
    </header><section class="post-excerpt"><div>
<p>Since <a href="http://www.grahamwheeler.com/posts/zite-replacement-2.html">yesterdays post on term extraction</a>, I've made a few tweaks. In particular I only adjust capitalization on the first words of sentences, I'm keeping numbers and hyphenation, and if there are consecutive capitalized words I turn them into single terms.</p>
<p>For example, the terms for the Donald Trump on vaccines article have changed from:</p>
<pre class="code literal-block"><span></span>vaccines
Donald
Trump
children
doses
effective
vaccinations
diseases
Carson
debate
</pre>


<p>to:</p>
<pre class="code literal-block"><span></span>vaccines
children
Donald Trump
doses
effective
vaccinations
diseases
smaller
vaccination
debate
babies
autism
cause
schedule
studies
</pre>


<p>I'm not sure why 'Carson' was dropped; it's possible that the text of the article changed between the two runs. This shows too that it may be good to deal with plural forms (so 'vaccination' covers 'vaccinations'); on the other hand, having three forms of vaccine appear certainly does strengthen the topic. There is certainly some more tweaking to do but overall I'm pretty happy.</p>
<p>The next step is classification. I was disappointed to find that the category element is rarely used in RSS (so far I haven't seen it). That is going to make using <a href="https://en.wikipedia.org/wiki/Supervised_learning">supervised learning</a> (where I have a set of training documents with known categories) quite tricky. Fortunately, <a href="https://en.wikipedia.org/wiki/Unsupervised_learning">unsupervised learning</a> can help a lot here! In unsupervised learning you just throw a bunch of data at a learning algorithm and it does useful things like <a href="https://en.wikipedia.org/wiki/Cluster_analysis">clustering</a> for you. Essentially this means I can use an algorithm like <a href="https://en.wikipedia.org/wiki/K-means_clustering">k-means</a> to group similar articles together. I can then go through those by hand and tag them much faster with categories, and then once they are tagged I can go back to using supervised learning.</p>
<p><em>k-means</em> is just one (very common) algorithm for unsupervised learning. There are some other interesting algorithms for topic extraction that may help here too. In the document classification field, a particularly promising one is <a href="https://en.wikipedia.org/wiki/Latent_Dirichlet_allocation">latent Dirichlet allocation</a>,  which is a form of <a href="https://en.wikipedia.org/wiki/Latent_semantic_analysis">latent semantic analysis</a>. It's fairly easy to implement but there is a great Python library for this (<a href="https://radimrehurek.com/gensim/">gensim</a>) that I will explore. But I am getting ahead of myself, because first I need a corpus of documents, and perhaps you can help!</p>
<p>In order to get my corpus, I need to gather a large number of URLs for RSS feeds. I have a list of about 40 tech feeds I used to follow back in the days when Google Reader was a thing. I've also pulled all the URLs out of my Pocket booksmarks - over 3000 - but these are article links, not feed URLs. So I am going to write a script that takes a bunch of article links and scrapes the pages to try find RSS feed URLs. Unfortunately, my interests are very skewed toward tech, with a bit of cooking, math and fitness thrown in. If you have collections of URLs or RSS feeds covering other topics I would be very happy to add them to my collection.</p>
<p>A first cut at such a script is:</p>
<table class="codehilitetable"><tr>
<td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td>
<td class="code">
<pre class="code literal-block"><span></span><span class="k">def</span> <span class="nf">get_feed_URL</span><span class="p">(</span><span class="n">site</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">site</span><span class="p">)</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">"&lt;link[^&gt;]*application/rss\+xml[^&gt;]*href=[</span><span class="se">\"</span><span class="s2">']([^</span><span class="se">\"</span><span class="s2">']+)[</span><span class="se">\"</span><span class="s2">']"</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">m</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">"&lt;a [^&gt;]*class=</span><span class="se">\"</span><span class="s2">rss</span><span class="se">\"</span><span class="s2">[^&gt;]*href=[</span><span class="se">\"</span><span class="s2">']([^</span><span class="se">\"</span><span class="s2">']+)[</span><span class="se">\"</span><span class="s2">']"</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">m</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">"&lt;a [^&gt;]*href=[</span><span class="se">\"</span><span class="s2">']([^</span><span class="se">\"</span><span class="s2">']+)[</span><span class="se">\"</span><span class="s2">'][^&gt;]*class=</span><span class="se">\"</span><span class="s2">rss</span><span class="se">\"</span><span class="s2">"</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>        
    <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
        <span class="n">feed</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">feed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'/'</span><span class="p">:</span>
            <span class="n">feed</span> <span class="o">=</span> <span class="n">site</span> <span class="o">+</span> <span class="n">feed</span>
        <span class="k">return</span> <span class="n">feed</span>
    <span class="k">return</span> <span class="bp">None</span>
</pre>
</td>
</tr></table>
<p>I'll post any updates later. If possible I may try write one that can be run against Pocket, and try get people to use that to send me already curated lists with possible tags. Watch this space.</p>
<p><em>Update:</em> Gotta love Python. A web search gave me <a href="http://www.aaronsw.com/2002/feedfinder/feedfinder.py">feedfinder</a>.</p>
</div>
    </section><footer class="post-meta"><a href="authors/graham-wheeler.html">Graham Wheeler</a>

        on

        <time class="post-date" datetime="2015-09-20T08:12:00-07:00">
            2015-09-20 08:12
        </time></footer></article><article class="post post"><header class="post-header"><h2 class="post-title"><a href="posts/zite-replacement-2.html">Building a Zite Replacement (Part 2)</a></h2>
    </header><section class="post-excerpt"><div>
<p>In the <a href="http://www.grahamwheeler.com/posts/zite-replacement-1.html">previous post</a> I gave an overview of what needs to be built for our <a href="http://zite.com/">Zite</a> replacement. In this post we will look at how to load an RSS feed and generate key terms for each article. In order to fetch the feed we will make use of the <a href="https://pypi.python.org/pypi/feedparser">feedparser</a> package, so make sure to install that first with pip, conda, or whatever you use.</p>
<p>Another thing we're going to want is to strip HTML tags from the articles. I did a Google for "HTML element stripper Python" and found <a href="http://stackoverflow.com/questions/753052/strip-html-from-strings-in-python">this StackOverflow post</a> with the code below that works great:</p>
<pre class="code literal-block"><span></span><span class="ch">#!python</span>
<span class="kn">from</span> <span class="nn">HTMLParser</span> <span class="kn">import</span> <span class="n">HTMLParser</span>

<span class="k">class</span> <span class="nc">MLStripper</span><span class="p">(</span><span class="n">HTMLParser</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fed</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span> <span class="nf">handle_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fed</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">strip_tags</span><span class="p">(</span><span class="n">html</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">MLStripper</span><span class="p">()</span>
    <span class="n">s</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
</pre>


<p>With that, let's begin. One of the things we will want to do is normalize capitalization of words. In particular, the first word in a sentence is capitalized and we want to in most cases undo that so we don't see two forms of the same word. One solution is to lower-case everything but that is throwing the baby out with the bathwater. A better solution is to look up each word in a dictionary. If we fail to find a match we can try the lower-case form.</p>
<p>There are probably libraries already to do this (NLTK?) but I did some early prototyping of the code in this post using the top 5000 words from <a href="http://www.wordfrequency.info/free.asp">this list</a>. So for now I'll just use that as a dictionary to normalize words. There are much more comprehensive lists out there without frequency information and I expect I'll replace this but due to my early experiments I had the word list loaded already.</p>
<p>If you're interested in using that list, you can copy/paste it into a spreadsheet and save it as a CSV once you have agreed to the terms. I used the code below to load that CSV file. I also put the top 198 words in a separate list that I was going to use to remove <a href="https://en.wikipedia.org/wiki/Stop_words">stop words</a>, but I ended up not needing that.</p>
<pre class="code literal-block"><span></span><span class="ch">#!python</span>
<span class="kn">import</span> <span class="nn">csv</span>

<span class="n">words5000</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">top_words</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'freq5000.csv'</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">''</span> <span class="ow">or</span> <span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="s1">'9'</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="n">v</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">word</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'ascii'</span><span class="p">,</span> <span class="s1">'ignore'</span><span class="p">)</span>
    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">&lt;=</span> <span class="mi">198</span><span class="p">:</span>
        <span class="n">top_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="n">words5000</span><span class="p">[</span><span class="n">word</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
    <span class="n">total</span> <span class="o">+=</span> <span class="n">v</span>
</pre>


<p>Next we will use a function that gets a dictionary with the words and counts from an article, and returns that plus the total number of words in the dictionary. It will do all the necessary work to strip tags, punctuation, and so on before computing the counts.</p>
<pre class="code literal-block"><span></span><span class="ch">#!python</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">string</span> 

<span class="k">def</span> <span class="nf">get_article_terms</span><span class="p">(</span><span class="n">article</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Get the terms and counts from an article. Strip HTML tags and</span>
<span class="sd">    non-essential punctuation, whitespace, and single</span>
<span class="sd">    character 'words' like s that may come from punctuation removal.</span>
<span class="sd">    Try normalize initial letter case using the 5000 word dictionary.</span>
<span class="sd">    Return a set of words and counts and a total count.</span>
<span class="sd">    """</span>
    <span class="n">terms</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Remove the HTML element tags</span>
    <span class="n">article</span> <span class="o">=</span> <span class="n">strip_tags</span><span class="p">(</span><span class="n">article</span><span class="p">)</span>
    <span class="c1"># replace non-ASCII chars with space</span>
    <span class="n">article</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">r'[^A-Za-z\-]+'</span><span class="p">,</span><span class="s1">' '</span><span class="p">,</span> <span class="n">article</span><span class="p">)</span>
    <span class="c1"># We could use a Counter here but the would need to post-process the keys </span>
    <span class="c1"># to remove the bogus ones and correct capitalization. Consider for later.</span>
    <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">article</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">' '</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">term</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="p">(</span><span class="n">term</span> <span class="o">!=</span> <span class="s1">'a'</span> <span class="ow">or</span> <span class="n">term</span> <span class="o">==</span> <span class="s1">'A'</span> <span class="ow">or</span> <span class="n">term</span> <span class="o">==</span> <span class="s1">'I'</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># Update the count. If the word is a new one then see if the lower</span>
        <span class="c1"># case form is in our dictionary and use that in preference.</span>
        <span class="k">if</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">:</span>
            <span class="n">terms</span><span class="p">[</span><span class="n">term</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lterm</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">lterm</span> <span class="ow">in</span> <span class="n">words5000</span><span class="p">:</span>
                <span class="n">term</span> <span class="o">=</span> <span class="n">lterm</span>
            <span class="n">terms</span><span class="p">[</span><span class="n">term</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">terms</span><span class="p">,</span> <span class="n">total</span>
</pre>


<p>The method we will use to get topics is something called <a href="https://en.wikipedia.org/wiki/Tf%E2%80%93idf">Term Frequency-Inverse Document Frequency</a> (TF-IDF). It essentially works by taking the frequency of a term in a document, and multiplying it by the log of the inverse of the number of documents the term occurs in. The idea is that the key terms will be words that occur frequently in <em>this</em> document relative to how frequently they occur in <em>all</em> the documents. Obviously words like 'the', 'and', etc have a high frequency in most documents, so they aren't interesting. But if a word that is uncommon in all the documents, like, say, 'pneumonia', occur relatively higher in a specific document, then that word is likely important.</p>
<p>A key part of this is that we need to count how many documents a word occurs in, not just how often it occurs in each document. So our next function is going to look at all the articles in a feed. Ideally we would compute the IDFs from a bigger corpus of documents, so that can be refined later (in fact, I used the top 5000 words as an alternative and they worked quite well too, but if every article in a feed include some boiler plate text, using the top 5000 words may not filter that out, but computing IDF just from the articles will).</p>
<pre class="code literal-block"><span></span><span class="ch">#!python</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">feedparser</span>

<span class="k">def</span> <span class="nf">get_article_data</span><span class="p">(</span><span class="n">feed_url</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Calculate the term counts for each article in a feed as well as</span>
<span class="sd">    the document counts for each term. Return a list of article metadata</span>
<span class="sd">    including the title, a snippet, the distinct terms and their counts, etc,</span>
<span class="sd">    as well as the counts of how many documents each term appeared in.</span>
<span class="sd">    """</span>

    <span class="n">d</span> <span class="o">=</span> <span class="n">feedparser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">feed_url</span><span class="p">)</span>

    <span class="n">doc_terms</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">()</span>
    <span class="n">articles</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">entries</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">'entries'</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

        <span class="c1"># For some sites seem we get summary and some content</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'summary'</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'content'</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">article</span> <span class="o">=</span> <span class="n">summary</span> <span class="k">if</span> <span class="n">content</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">content</span>

        <span class="n">terms</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="n">get_article_terms</span><span class="p">(</span><span class="n">article</span><span class="p">)</span>
        <span class="n">doc_terms</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">terms</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">articles</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">'title'</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span> <span class="s1">'leader'</span><span class="p">:</span> <span class="n">article</span><span class="p">[:</span><span class="mi">100</span><span class="p">],</span>
                        <span class="s1">'terms'</span><span class="p">:</span> <span class="n">terms</span><span class="p">,</span> <span class="s1">'count'</span><span class="p">:</span> <span class="n">count</span><span class="p">,</span> 
                        <span class="s1">'link'</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'link'</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
                        <span class="s1">'date'</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'published_parsed'</span><span class="p">,</span> <span class="bp">None</span><span class="p">)})</span>
    <span class="k">return</span> <span class="n">articles</span><span class="p">,</span> <span class="n">doc_terms</span>
</pre>


<p>Now we can use this function to compute the TF-IDFs for all the articles in a feed:</p>
<pre class="code literal-block"><span></span><span class="ch">#!python</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="k">def</span> <span class="nf">get_feed_with_tf_idf</span><span class="p">(</span><span class="n">feed_url</span><span class="p">):</span>
    <span class="sd">""" Calculate TF-IDFs for each article in a feed and add to metadata """</span>
    <span class="n">articles</span><span class="p">,</span> <span class="n">doc_terms</span> <span class="o">=</span> <span class="n">get_article_data</span><span class="p">(</span><span class="n">feed_url</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">article</span> <span class="ow">in</span> <span class="n">articles</span><span class="p">:</span>
        <span class="n">terms</span> <span class="o">=</span> <span class="n">article</span><span class="p">[</span><span class="s1">'terms'</span><span class="p">]</span>
        <span class="n">tf_idf</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">article_count</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">article</span><span class="p">[</span><span class="s1">'count'</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">term</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">terms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">tf_idf</span><span class="p">[</span><span class="n">term</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">count</span> <span class="o">/</span> <span class="n">article_count</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">articles</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">doc_terms</span><span class="p">[</span><span class="n">term</span><span class="p">]))</span>
        <span class="n">article</span><span class="p">[</span><span class="s1">'tf_idf'</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf_idf</span>
    <span class="k">return</span> <span class="n">articles</span>
</pre>


<p>And we're basically done! Let's see how well it worked. We can try it out on the HuffPost and print out the top ten terms for each article:</p>
<pre class="code literal-block"><span></span><span class="ch">#!python</span>
<span class="kn">import</span> <span class="nn">operator</span>

<span class="n">articles</span> <span class="o">=</span> <span class="n">get_feed_with_tf_idf</span><span class="p">(</span><span class="s1">'http://www.huffingtonpost.com/feeds/index.xml'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">article</span> <span class="ow">in</span> <span class="n">articles</span><span class="p">:</span>
    <span class="n">rank</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">article</span><span class="p">[</span><span class="s1">'tf_idf'</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">print</span> <span class="s1">'</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">article</span><span class="p">[</span><span class="s1">'title'</span><span class="p">],</span> <span class="n">article</span><span class="p">[</span><span class="s1">'leader'</span><span class="p">],</span> 
                            <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rank</span><span class="p">[:</span><span class="mi">10</span><span class="p">]))</span>
</pre>


<p>Running this right  now gives the results below. Not bad for a first attempt! Note that the titles that are printed out were not included in the term counts and so are a good test (although in practice it would make sense to include these so they can help rank the terms).</p>
<pre class="code literal-block"><span></span>iPhone Shopping? Beware: Madness Ahead!
If you're thinking of upgrading your aging iPhone - I've just gone through all the pain and sufferin
iPhone
ATT
Verizon
phone
customers
line
phones
sell
you
month

Ted Cruz Declines To Say Whether He Thinks Obama Is A Christian
&lt;div class="embed-asset embed"&gt;&lt;br /&gt;
        &lt;div class="embed-code"&gt;&lt;span class="js-fivemin-script
Cruz
Christian
president
policies
speculate
Muslim
contributed
comments
Obama
faith

How to Help Shatter the Class Ceiling - Elect Bernie Sanders
Let's make history. The 2016 election offers a rare moment to crack a barrier that can truly transfo
percent
Sanders
poverty
income
Sen
far
African-Americans
wealth
trillion
households

2-Year-Old Baby, 2 Others Gunned Down Inside Utah Home
&lt;br /&gt;
&lt;p class="ap-story-p"&gt;SALT LAKE CITY (AP) -- Police in Utah arrested a 32-year-old man on Sat
Chipping
Tran
inside
boy
-year-old
home
victims
arrested
Poike
bodies

Pope Francis Praises U.S.-Cuba Detente As Model For World
&lt;br /&gt;
&lt;p&gt;HAVANA (AP) &amp;mdash; Pope Francis hailed detente between the United States and Cuba as a mo
Cuba
Francis
visit
Cuban
pope
Raul
United
reconciliation
airport
travel

Reminding Yourself You're F&amp;^*% Hot (Step 1)
Ladies, there are so many facets in our struggle of masculine dominated life that project us to eith
Kyle
hot
hotness
itself
swear
moment
was
re
know
exact

A Pope That Congress Should Listen To
When the Pope takes center stage in the heart of the nation's capital next Thursday, Americans will 
Pope
values
village
community
energy
Iran
person
culture
peace
world

Donald Trump &amp; Vaccines: Is He Ready To Be Responsible For A Children's Epidemic?
&lt;strong&gt;Donald Trump may be a big blowhard, espousing his belief that there's a link between vaccine
vaccines
Donald
Trump
children
doses
effective
vaccinations
diseases
Carson
debate

What You Should Do If You Own A Volkswagen That Was Just Recalled
&lt;div class="embed-asset embed"&gt;&lt;br /&gt;
        &lt;div class="embed-code"&gt;&lt;span class="js-fivemin-script
Volkswagen
vehicles
loaner
recalled
car
cars
risking
diesel-power
vehicle
safety

5 Reasons People May Not Be Following Your Leadership
There are times throughout a leader's tenure that he/she must look behind them and see if anyone is 
team
lead
leader
regularly
disorganized
leadership
clarity
praise
follow
you

How To Deal With These 3 Difficult Managers At Work
One of the biggest challenges for any employee is learning how to work well with a manager. A good w
manager
Gary
Pleasing
Patricia
personality
difficult
Mitchell
Micromanaging
Goal-Focused
she

Experts: Cybersecurity Attacks Slow Ahead Of Obama's Meeting With Chinese President
&lt;br /&gt;
&lt;p&gt;WASHINGTON, Sept 19 (Reuters) - Major intrusions by Chinese hackers of U.S. companies' com
Chinese
cybersecurity
Mandia
China
said
breaches
companies
McClure
Inc
Xi

6 Tips for the Unmotivated Student: How to Stay on Track After the First Week of School
&lt;em&gt;Co-authored by &lt;a href="https://twitter.com/just1trunk" target="_hplink"&gt;Ashley Carter&lt;/a&gt;, staf
study
buddy
semester
your
home
media
studying
excited
coffee
finding

3 Proven Ways To Help You Achieve Your Goals
It's sad to think how many people go their whole lives dreaming of goals that they will never hit. W
goals
hit
everyday
everything
your
ll
business
want
habit
consistent

Huckabee: Obama Nominated Openly Gay Army Head To 'Appease Homosexuals'
&lt;div class="embed-asset embed"&gt;&lt;br /&gt;
        &lt;div class="embed-code"&gt;&lt;span class="js-fivemin-script
military
Fanning
Huckabee
Carter
gay
nomination
openly
undersecretary
appointment
experiments
</pre>
</div>
    </section><footer class="post-meta"><a href="authors/graham-wheeler.html">Graham Wheeler</a>

        on

        <time class="post-date" datetime="2015-09-19T16:18:00-07:00">
            2015-09-19 16:18
        </time></footer></article><article class="post post"><header class="post-header"><h2 class="post-title"><a href="posts/zite-replacement-1.html">Building a Zite Replacement (Part 1)</a></h2>
    </header><section class="post-excerpt"><div>
<p>The two most used apps on my phone are <a href="http://zite.com/">Zite</a> and <a href="https://getpocket.com/">Pocket</a>. Unfortunately last year Zite was bought by Flipboard and has slowly been getting worse. Recently the top sticky article on Zite has been a post on migrating your preferences to Flipboard, but suggests Zite is not much longer for this world.</p>
<p>This would be okay if Flipboard was a suitable replacement, but it isn't. It's very flashy (which I don't like), and just doesn't seem to get things right when it comes to serendipitous discovery of interesting content. My feeling is that it is probably a great app for people who are interested in news and pop culture, but my interests run more specialized; I want to read about certain programming languages and fields of math, computer science and statistics.</p>
<p>A few days ago Zite had a half day outage and I decided that it was time to hedge my bets. If no-one else has made the app that I want, I'll just have to do it myself.</p>
<p>So what is involved? Amongst other things:</p>
<ul>
<li>a corpus of documents of potential interest</li>
<li>a way of determining the topics discussed in each document</li>
<li>a way of classifying the documents into a broader set of categories, based on the topics</li>
<li>a way of ranking each document within the category</li>
<li>a database or some other store for the results, and an API to query these</li>
<li>an app to consume the resulting content in a way that is easy to use, efficient, and supports various options like blocking sites that are not interesting, upvoting/downvoting the suggested results to improve future results, and saving/sharing the results. Such an app would require some form of identity for personalization, assume I'm not the only one using it.</li>
</ul>
<p>Apart from the app part, the rest of these are all back-end server tasks, and while the amount of data to be processed may be large the task is not too hard. As for the app, I realized an easy solution at first is to not build an app at all. There are other ways to consume the results; for example a daily digest e-mail, or saving the results straight to an app like Pocket or Evernote from where they can be read/deleted/etc. This loses the ability to upvote/downvote/etc but that can come later.</p>
<p>As for the corpus of documents that serve as input, there are a number of ways to source these:</p>
<ul>
<li>RSS feeds are an obvious first choice</li>
<li>Digest-style e-mails that contain useful sets of links - e.g. O'Reilly has weekly newsletters in areas like Programming, Big Data, etc that can be great input (especially as it is already curated)</li>
<li>Posting on social community groups like G+ communities</li>
<li>Twitter, Facebook and LinkedIn postings by thought leaders </li>
</ul>
<p>These are just a few ideas; the first source will definitely be RSS feeds though as they have many useful properties in their metadata.</p>
<p>The main other challenge is the classification task. This is typically going to involve supervised machine learning which means you need a large collection of previously classified articles to learn from.  Thankfully RSS includes article categories so hopefully that will be enough to go on.</p>
<p>Anyway, enough talk. In my next posting I'll look at how to do step 2, namely topic extraction, from RSS feeds.</p>
</div>
    </section><footer class="post-meta"><a href="authors/graham-wheeler.html">Graham Wheeler</a>

        on

        <time class="post-date" datetime="2015-09-19T14:12:00-07:00">
            2015-09-19 14:12
        </time></footer></article><article class="post post"><header class="post-header"><h2 class="post-title"><a href="posts/mine.html">A Clean Sweep</a></h2>
    </header><section class="post-excerpt"><div>
<p>A long time ago when dinosaurs roamed the earth I was following an academic career. That got subverted but I
enjoyed it while it lasted. Apart from graduate courses in compilers, I got to teach everything from 
computer architecture to assembly language programming to an introductory computing course for social
science students.</p>
<p>When teaching assembly language (in which I was lucky enough to be able to use the M68000, a dream of a 
processor), one of the samples I used to illustrate a number of topics like multi-dimensional arrays,
recursion and function pointers, was a Mine Sweeper game. I recently dug it out and turned in into Python
just for the heck of it.</p>
<p>So here it is. There are no fancy graphics, the field is just printed out as a 2D array of ASCII characters.
To enter a move you use coordinates using a number for the row and letter for the column. E.g. 1C is the
first row, third column (rows are numbered from 1, not 0). You can plant a flag (or clear it) by preceding 
your move with a '-'.</p>
<p>At some point I might look at using PyQt or something to turn it into a mouse-driven more attractive looking
game. But the interesting stuff is the recursive traversal of the board.</p>
<table class="codehilitetable"><tr>
<td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79</pre></div></td>
<td class="code">
<pre class="code literal-block"><span></span><span class="kn">import</span> <span class="nn">random</span>

<span class="n">DIMENSION</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">MINES</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">EXPOSED</span> <span class="o">=</span> <span class="mh">0x10</span>
<span class="n">FLAG</span> <span class="o">=</span> <span class="mh">0x20</span>
<span class="n">MINE</span> <span class="o">=</span> <span class="mh">0x40</span>

<span class="n">exposed</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">traverse</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="p">[</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">DIMENSION</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">col</span> <span class="o">&lt;</span> <span class="n">DIMENSION</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span> <span class="o">!=</span> <span class="n">r</span> <span class="ow">or</span> <span class="n">col</span> <span class="o">!=</span> <span class="n">c</span><span class="p">)</span> <span class="ow">and</span>
                        <span class="ow">not</span> <span class="n">field</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">EXPOSED</span><span class="p">:</span>
                    <span class="n">fn</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">check_neighbor</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="n">field</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">field</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">MINE</span> <span class="k">else</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">init_field</span><span class="p">():</span>
    <span class="n">field</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">DIMENSION</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DIMENSION</span><span class="p">)]</span>
    <span class="c1"># Place mines.</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">MINES</span>
    <span class="k">while</span> <span class="n">m</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">DIMENSION</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">DIMENSION</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">!=</span> <span class="n">MINE</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">field</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">MINE</span>
    <span class="c1"># Compute neighbor scores       </span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DIMENSION</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DIMENSION</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">field</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">!=</span> <span class="n">MINE</span><span class="p">:</span>
                <span class="n">traverse</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">check_neighbor</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">field</span>

<span class="k">def</span> <span class="nf">recursive_expose</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">exposed</span>
    <span class="n">cell</span> <span class="o">=</span> <span class="n">field</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">cell</span> <span class="o">&lt;</span> <span class="mh">0x10</span><span class="p">:</span>  <span class="c1"># Not a mine, flag or exposed</span>
        <span class="n">exposed</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">field</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">|=</span> <span class="n">EXPOSED</span>
        <span class="k">if</span> <span class="n">cell</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">traverse</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">recursive_expose</span><span class="p">);</span>

<span class="k">def</span> <span class="nf">expose</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="n">recursive_expose</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">field</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">MINE</span>

<span class="k">def</span> <span class="nf">print_field</span><span class="p">(</span><span class="n">field</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">'   '</span> <span class="o">+</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="mi">65</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DIMENSION</span><span class="p">)]))</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DIMENSION</span><span class="p">):</span>
        <span class="n">cells</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DIMENSION</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">field</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">FLAG</span><span class="p">:</span>
                <span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'F'</span><span class="p">)</span>  <span class="c1"># no newline</span>
            <span class="k">elif</span> <span class="n">field</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">EXPOSED</span><span class="p">:</span>
                <span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'*'</span> <span class="k">if</span> <span class="n">field</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">MINE</span> <span class="k">else</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s1">'0'</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">field</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xf</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'#'</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">'</span><span class="si">%02d</span><span class="s1"> '</span> <span class="o">%</span> <span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cells</span><span class="p">))</span>

<span class="n">field</span> <span class="o">=</span> <span class="n">init_field</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="s2">"CLEAR"</span>
<span class="k">while</span> <span class="n">exposed</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">DIMENSION</span> <span class="o">*</span> <span class="n">DIMENSION</span> <span class="o">-</span> <span class="n">MINES</span><span class="p">):</span>
    <span class="n">print_field</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
    <span class="n">move</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s2">"Move?"</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">move</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">c</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">move</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="mi">65</span>
    <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">field</span><span class="p">[</span><span class="o">-</span><span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">^=</span> <span class="n">FLAG</span>
    <span class="k">elif</span> <span class="n">expose</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">"BOOM!"</span>
        <span class="k">break</span>

<span class="n">print_field</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre>
</td>
</tr></table>
</div>
    </section><footer class="post-meta"><a href="authors/graham-wheeler.html">Graham Wheeler</a>

        on

        <time class="post-date" datetime="2015-09-16T20:49:00-07:00">
            2015-09-16 20:49
        </time></footer></article><article class="post post"><header class="post-header"><h2 class="post-title"><a href="posts/maslow-team.html">Maslow's Hierarchy and your Team</a></h2>
    </header><section class="post-excerpt"><div>
<p>I mentioned in a previous post that I would talk about Maslow's <a href="https://en.wikipedia.org/wiki/Maslow%27s_hierarchy_of_needs">Hierarchy of Needs</a> in relation to team health. </p>
<p>Maslow described a set of layers of needs with respect to human motivation:</p>
<ul>
<li>physiological - the basic needs for survival (food, water, shelter, air, etc)</li>
<li>safety - health, well-being, security</li>
<li>love/belonging - friends and family</li>
<li>esteem - respect of others and (more importantly) self-respect</li>
<li>self-actualization - becoming the most you can be</li>
<li>self-transcendence - altruism and given of yourself to others</li>
</ul>
<p>Maslow considered the first four to be necessary for mental health and a pre-requisite for self-actualization
and transcendence.
This hierarchy of needs is a useful model; it's not science but can help us understand shortcomings in ourselves
and others that may need addressing to reach our full potential.</p>
<p>So how does this relate to teams and management? We can come up with a similar set of needs for healthy teams 
and team members:</p>
<ul>
<li>physiological - this goes without saying unless you're trying to operate in a war zone</li>
<li>safety - as a tech worker, this usually isn't an issue so I'll take it as a given too</li>
<li>belonging - in a team context this relates to psychological safety. Do you have a hostile workplace? Or do people feel safe to be themselves? Are roles and reponsibilities clear? Are team members supportive of one another or are they trying to stab each other in the back? This relates to organizational culture - can you get ahead while helping others grow or by pushing them out of the way? The former is healthy while the latter is not. </li>
<li>esteem - do people take their work seriously? Do you hire good people? Are people dependable and good are meeting their commitments? Do people have clear goals and are there well-understood processes?</li>
<li>self-actualization - do people enjoy their jobs? Do they feel like they are learning/growing? Do you have the right people doing the right work, so that they are motivated and excited about what they are doing individualy?</li>
<li>self-transcendence - as a team, do people think their work matters and they are making a difference in the world? Do you have a clear vision statement so everyone understands what they are working towards collectively? Do you celebrate your accomplishments together?</li>
</ul>
<p>You can use these layers as a way to think about, evaluate and improve the health of your team.</p>
</div>
    </section><footer class="post-meta"><a href="authors/graham-wheeler.html">Graham Wheeler</a>

        on

        <time class="post-date" datetime="2015-09-15T07:38:00-07:00">
            2015-09-15 07:38
        </time></footer></article><article class="post post"><header class="post-header"><h2 class="post-title"><a href="posts/1-1s-hike.html">1-on-1s can take a hike!</a></h2>
    </header><section class="post-excerpt"><div>
<p>Are you a people manager? Do you enjoy doing 1-1s with your reports? No? Then you're doing them wrong!</p>
<p>1-1s are a valuable and important part of both managing your team and becoming a better manager. You should see them as as much for your benefit as for your reports - arguably more so! Not only are you getting the opportunity to keep your reports on track and on a growth path, but it's a great opportunity to get feedback yourself. Unless you're the kind of manager who thinks managing is all about giving orders and having them carried out, in which case this post isn't for you; go enlist or something.</p>
<p>There are a number of reasons why managers (and employees) don't enjoy 1-1s:</p>
<ul>
<li>there isn't enough to talk about</li>
<li>there is no personal rapport</li>
<li>lack of social skills make them uncomfortable</li>
<li>there is a real performance issue that is festering</li>
</ul>
<p>None of these should be real issues if 1-1s are done correctly.</p>
<p>Regarding the first point, "there isn't enough to talk about" - this is typically because you are meeting too often or not planning the content of your meetings. Unless there is a serious HR or performance issue being addressed, you don't need weekly 1-1s. In most cases every two weeks is just fine, and in some cases (where teams work closely and have daily stand up, etc, so everyone knows what others are doing) once a month may be enough. Twenty minutes to half an hour should be plenty of time.</p>
<p>As for topics for discussion, this is a good reason to have your reports keep a log of their work. If you are
keeping track of what people are doing through daily standup, the 1-1 is more of a retrospective. It's a time
to discuss recent achievements, perhaps to celebrate them, or to do a post-mortem and figure out how they
could have gone better. It's also a time for you to get feedback from your report on how you are doing as
a manager, and what you can do to help make your reports more productive, happy and motivated (I'll discuss
some of this more in a future post in relation to Maslow's <a href="https://en.wikipedia.org/wiki/Maslow%27s_hierarchy_of_needs">Hierarchy of Needs</a>). In other words, 1-1s are best suited as ways to keep a regular review/feedback 
loop going, not for goal setting/tracking. The excepttion is career development discussions, which are forward
looking. A key part of this is that there should be no surprises if when you come to annual or bi-annual 
performace reviews; these should be perfunctory if the 1-1s are bing done right. The worst managers I have 
had have always been ones in which there was a total disconnect between what was being said in 1-1s and what
happened in the performance review (admittedly, some toxic cultural approaches to performce reviews can force
these surprises on people regardless but if they happen its likely your manager has been a poor advocate for 
you).</p>
<p>As far as a lack of personal rapport - how do you think this will ever develop if you don't take the time to try to develop it? You should use some of the time to get a sense of your report's interests and life outside of work. Like it or not, people bring their emotional baggage with them to work and if you want to have physically and mentally healthy people on your time you should take an interest in people's lives.  Much the same goes for a lack of social skills (I assume your report has this problem, else why are you a manager?). Make your reports comfortable and this will not be an issue.</p>
<p>Outside of performance issues uncomfortable 1-1s are more likely environmental in nature. Are you sitting behind a desk and having a conversation in a way in which there is an obvious imbalance of power? At the very least get on the same side of the desk as your report. But much better than that - get out of the office. Go take a walk. It's a great way to conduct 1-1s; it is refreshing, you don't need to make eye contact much (immediately eliminating much of the social discomfort), and it has a calming influence on all involved. If you are lucky enough to work in a nice area, the walk itself could be enough to make everyone look forward to their 1-1s. And that is a real measure of success.</p>
<blockquote>
<p>Written with <a href="https://stackedit.io/">StackEdit</a>.</p>
</blockquote>
</div>
    </section><footer class="post-meta"><a href="authors/graham-wheeler.html">Graham Wheeler</a>

        on

        <time class="post-date" datetime="2015-09-12T21:09:00-07:00">
            2015-09-12 21:09
        </time></footer></article><article class="post post"><header class="post-header"><h2 class="post-title"><a href="posts/sudoku.html">Simply Solving Sudoku</a></h2>
    </header><section class="post-excerpt"><div>
<p>It's been a long time since I last blogged. I've been meaning to for oh so long but you know what they say about the road to hell. For a while I maintained my <a href="http://www.magimathics.com">math blog</a> but even that has been fallow for some time.</p>
<p>Fortunately, I stumbled upon Peter Norvig's <a href="http://norvig.com/sudoku.html">article</a> about solving Sudoku, and that has provided the impetus. His approach is probably the most sensible I have seen for a while; there seem to be some really bad solvers out there. I was unimpressed with the one by Skiena in the  <a href="http://www.algorist.com/">Algorithm Design Manual</a>,  although the truly ridiculous one has to be the so-overblown-I-took-a-whole-book approach in <a href="http://www.amazon.com/Programming-Sudoku-Technology-Action-Wei-Meng/dp/1590596625">Programming Sudoku</a>;  the mind simply boggles at how complex some people make trivial things.</p>
<p>Because solving Sudoku is indeed trivial. There is nothing to it. All you need is a very simple backtracking search. I wrote the solver below originally more than 10 years ago in Javascript and it was used as a generator running on extremely low-powered Microsoft SPOT smart watches. For fun I dug it out, turned it into Python, and tested it on <a href="https://www.kristanix.com/sudokuepic/worlds-hardest-sudoku.php">"the world's hardest Sudoku puzzle"</a>. How fast can you blink?</p>
<p>But still some people <a href="https://gigaom.com/2012/10/12/meet-the-algorithm-thats-way-better-than-you-at-sudoku/">make a big deal out of it all</a>...</p>
<table class="codehilitetable"><tr>
<td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62</pre></div></td>
<td class="code">
<pre class="code literal-block"><span></span><span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xffff</span><span class="p">]</span> <span class="o">*</span> <span class="mi">9</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xffff</span><span class="p">]</span> <span class="o">*</span> <span class="mi">9</span>
<span class="n">rgns</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xffff</span><span class="p">]</span> <span class="o">*</span> <span class="mi">9</span>
<span class="n">board</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">81</span>

<span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="n">puz</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">board</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">rgns</span><span class="p">,</span> <span class="n">board</span>
    <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">puz</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">ch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
            <span class="n">board</span><span class="p">[</span><span class="n">r</span> <span class="o">*</span> <span class="mi">9</span> <span class="o">+</span> <span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">ch</span>
            <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span> <span class="s1">'.'</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">m</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span> <span class="o">-</span> <span class="mi">48</span><span class="p">))</span>
            <span class="n">rows</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&amp;=</span> <span class="n">m</span>
            <span class="n">cols</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">&amp;=</span> <span class="n">m</span>
            <span class="n">rgns</span><span class="p">[(</span><span class="n">r</span> <span class="o">//</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="n">c</span> <span class="o">//</span> <span class="mi">3</span><span class="p">)]</span> <span class="o">&amp;=</span> <span class="n">m</span>

<span class="k">def</span> <span class="nf">fill</span><span class="p">(</span><span class="n">pos</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">board</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">rgns</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="mi">81</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">'.'</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fill</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">//</span> <span class="mi">9</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">%</span> <span class="mi">9</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">cols</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">allowed</span><span class="p">:</span>
        <span class="n">rg</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span> <span class="o">//</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="n">c</span> <span class="o">//</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">allowed</span> <span class="o">&amp;=</span> <span class="n">rgns</span><span class="p">[</span><span class="n">rg</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">allowed</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
                <span class="n">tm</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span>
                <span class="k">if</span> <span class="n">allowed</span> <span class="o">&amp;</span> <span class="n">tm</span><span class="p">:</span>
                    <span class="n">im</span> <span class="o">=</span> <span class="o">~</span><span class="n">tm</span>
                    <span class="n">rows</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&amp;=</span> <span class="n">im</span>
                    <span class="n">cols</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">&amp;=</span> <span class="n">im</span>
                    <span class="n">rgns</span><span class="p">[</span><span class="n">rg</span><span class="p">]</span> <span class="o">&amp;=</span> <span class="n">im</span>
                    <span class="k">if</span> <span class="n">fill</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="n">board</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">48</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
                        <span class="k">return</span> <span class="bp">True</span>
                    <span class="n">rows</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">|=</span> <span class="n">tm</span>
                    <span class="n">cols</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">|=</span> <span class="n">tm</span>
                    <span class="n">rgns</span><span class="p">[</span><span class="n">rg</span><span class="p">]</span> <span class="o">|=</span> <span class="n">tm</span>
    <span class="k">return</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="n">puz</span><span class="p">):</span>
    <span class="n">init</span><span class="p">(</span><span class="n">puz</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fill</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="k">if</span> <span class="n">solve</span><span class="p">([</span>
<span class="s2">"1....7.9."</span><span class="p">,</span>
<span class="s2">".3..2...8"</span><span class="p">,</span>
<span class="s2">"..96..5.."</span><span class="p">,</span>
<span class="s2">"..53..9.."</span><span class="p">,</span>
<span class="s2">".1..8...2"</span><span class="p">,</span>
<span class="s2">"6....4..."</span><span class="p">,</span>
<span class="s2">"3......1."</span><span class="p">,</span>
<span class="s2">".4......7"</span><span class="p">,</span>
<span class="s2">"..7...3.."</span>
<span class="p">]):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span>
        <span class="k">print</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">9</span><span class="p">])</span>
</pre>
</td>
</tr></table>
<blockquote>
<p>Written with <a href="https://stackedit.io/">StackEdit</a>.</p>
</blockquote>
</div>
    </section><footer class="post-meta"><a href="authors/graham-wheeler.html">Graham Wheeler</a>

        on

        <time class="post-date" datetime="2015-09-10T22:03:00-07:00">
            2015-09-10 22:03
        </time></footer></article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-5.html" rel="next">Older posts</a>
            </li>
        </ul></nav><script>var disqus_shortname="randomforest";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script></main><footer class="site-footer clearfix"><section class="poweredby">Contents © 2018         <a href="mailto:gram@geekraver.com">Graham Wheeler</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </section></footer>
</div>

    <script type="text/javascript" src="assets/js/jquery.js"></script><script type="text/javascript" src="assets/js/jquery.fitvids.js"></script><script type="text/javascript" src="assets/js/index.js"></script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-67535606-1', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>
